# Introduction to XXE (XML External Entity) Vulnerability  

**XML External Entity** (XXE) vulnerability is a security flaw that occurs when an application processes XML input containing external entity references. If improperly configured, XML parsers can allow attackers to read sensitive files, execute remote code, or conduct server-side request forgery (SSRF) attacks.  

**XXE vulnerabilities** arise due to the way XML parsers handle **external entities**, which are special placeholders that can reference files, URLs, or system commands. If an attacker crafts a malicious XML payload, they can exploit the parser to gain unauthorized access to sensitive information.  

### What Are External XML Entities?  

In XML, an **entity** is a placeholder for data that can be reused in a document. There are two types of entities:  

1. **Internal Entities** – Defined within the XML file itself and used within the document.  
2. **External Entities** – Reference external resources, such as system files or remote URLs.  

An external entity is typically declared like this:  

```xml
<!DOCTYPE data [
  <!ENTITY myEntity SYSTEM "file:///etc/passwd">
]>
<data>&myEntity;</data>
```

If a vulnerable XML parser processes this file, it will replace `&myEntity;` with the contents of `/etc/passwd`, potentially exposing sensitive system files.  

### Exploitation Techniques  

1. **File Disclosure** – Attackers use external entities to read server files, such as configuration files containing credentials.  
2. **SSRF (Server-Side Request Forgery)** – The XML parser is tricked into making unauthorized HTTP requests, potentially accessing internal services.  
3. **Denial of Service (Billion Laughs Attack)** – A recursive entity reference overloads system memory, causing a crash.  
4. **Remote Code Execution (RCE)** – In certain cases, XXE can be leveraged to execute commands on the server.  

### Impact of XXE  

- Exposure of sensitive server files (e.g., database credentials, API keys).  
- Unauthorized access to internal networks through SSRF.  
- Disruption of application availability due to resource exhaustion.  
- Possible compromise of the entire server if combined with other vulnerabilities.  

### Mitigation Strategies  

To prevent XXE attacks, developers should:  

- **Disable external entity processing** in XML parsers (`disable DTD` or `disable ENTITY expansion`).  
- **Use safer alternatives** like JSON instead of XML when possible.  
- **Validate and sanitize XML input** to prevent attackers from injecting malicious entities.  
- **Implement a secure parser** that does not process external entities by default.  
- **Use a web application firewall (WAF)** to detect and block malicious XML payloads.  
