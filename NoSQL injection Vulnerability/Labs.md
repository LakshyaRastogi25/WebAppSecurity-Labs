# LAB 1: Detecting NoSQL injection

## **Overview**
This write-up demonstrates a NoSQL injection vulnerability in a web application using JavaScript-based queries. By manipulating the category filter parameter, we can modify the query logic to retrieve unauthorized data, including unreleased products.

## **Steps to Exploit the Vulnerability**

### **1. Identify Injection Point**
- Open **Burp's browser** and access the lab.
- Click on a product **category filter**.
- In Burp, navigate to **Proxy > HTTP history**.
- Locate the category filter request, **right-click** it, and select **Send to Repeater**.

### **2. Test for JavaScript Injection**
- In **Repeater**, modify the `category` parameter by adding a single quote (`'`) and submit the request:
  ```
  Food+%26+Drink'
  ```
- Observe the response. If a **JavaScript syntax error** occurs, this suggests the input is not properly sanitized.

### **3. Inject a Valid JavaScript Payload**
- To verify if controlled injection is possible, submit the following payload:
  ```
  Food+%26+Drink'+'
  ```
- **URL-encode** the payload (Ctrl+U in Burp Suite).
- If no syntax error occurs, this indicates potential **server-side injection**.

### **4. Testing Boolean-Based Injection**
#### **False Condition Injection (No Products Retrieved)**
- Modify the `category` parameter to inject a **false condition**:
  ```
  Food+%26+Drink' && 0 && 'x
  ```
- **URL-encode** and submit the request.
- If no products are retrieved, the application is evaluating the injected condition.

#### **True Condition Injection (Products Retrieved)**
- Modify the `category` parameter to inject a **true condition**:
  ```
  Food+%26+Drink' && 1 && 'x
  ```
- **URL-encode** and submit the request.
- If products in the "Gifts" category appear, the injection is successful.

### **5. Extracting Hidden Data**
- Inject a condition that always evaluates to **true**:
  ```
  Food+%26+Drink'||1||'
  ```
- **Right-click the response** in Burp and select **Show response in browser**.
- Copy the URL and open it in Burp's browser.
- If the response contains **unreleased products**, the lab is successfully exploited.
  
---

# **Lab: Exploiting NoSQL operator injection to bypass authentication**  

## **Objective**  
Bypass authentication in a NoSQL-based application by injecting MongoDB operators to gain administrative access.

---

## **Steps to Exploit the Vulnerability**  

### **1. Capture the Login Request in Burp Suite**  
1. Open **Burp's browser** and navigate to the application's login page.  
2. Log in using the provided credentials:  
   ```
   Username: wiener  
   Password: peter  
   ```
3. Go to **Burp Suite** → **Proxy** → **HTTP history**.  
4. Locate the `POST /login` request and **right-click** on it.  
5. Select **Send to Repeater** to modify and test the request.

---

### **2. Testing for NoSQL Injection**  
1. In **Repeater**, identify the **username** and **password** parameters in the request body.  
2. Modify the parameters to inject MongoDB query operators:  

   ```json
   {
     "username": { "$regex": "admin.*" },
     "password": { "$ne": "" }
   }
   ```
3. Click **Send** to submit the modified request.  

#### **Explanation of Payload:**  
- **`"$regex": "admin.*"`** → Matches any username that starts with `"admin"`.  
- **`"$ne": ""`** → Ensures the password is **not empty**.  
- If successful, the database returns the **first matching admin user**, granting access.

---

### **3. Logging in as Administrator**  
1. If the response indicates successful authentication, **right-click** the response.  
2. Select **Show response in browser** and **copy the URL**.  
3. Paste the copied URL into **Burp's browser**.  
4. You are now **logged in as the administrator** and have successfully bypassed authentication.  

---

