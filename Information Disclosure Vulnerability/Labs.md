### Lab: Information disclosure in version control history
----
**1. Identifying the Vulnerability:**

The lab contained an exposed .git directory, which allowed access to the version control history of the application.

By browsing to http://<lab-id>.web-security-academy.net/.git/, I was able to confirm the presence of Git version control data.

Downloading the .git Directory:

Using the wget command, I recursively downloaded the entire .git directory:

````
wget -r https://<lab-id>.web-security-academy.net/.git/
````
This fetched all the Git repository metadata, including commit history and configuration files.

**2. Reconstructing the Git Repository:**

After downloading the .git directory, I navigated to the directory and used Git to reset and reconstruct the repository:

cd <downloaded-directory>/.git/

This restored the repository to its last known state based on the commit history.

Analyzing the Commit History:

**3.I checked the commit history using the command:**
````
git log --oneline
````
**4. This revealed two commits:**
````
5b2a1ea: "Remove admin password from config"

6994af5: "Add skeleton admin panel"
````
The relevant commit for the lab was 5b2a1ea, which mentioned the removal of the admin password from the configuration file (admin.conf).

**5. Inspecting the Commit Diff:**

To examine the specific changes made in commit 5b2a1ea, I used:
````
git show 5b2a1ea
````
The diff revealed that the commit replaced a hard-coded admin password (4ogk1bxrznrobkl1prxn) with an environment variable (env('ADMIN_PASSWORD')).

The hard-coded password was still visible in the commit diff, which was the key piece of information needed to log in as the administrator.

**Logging in to the Admin Panel:**

With the leaked password (4ogk1bxrznrobkl1prxn), I navigated to the admin login page of the lab.

Using the username administrator and the leaked password, I successfully logged in to the admin interface.

Deleting the User "Carlos":

After gaining access to the admin panel, I followed the instructions in the lab to delete the user "Carlos."

This completed the labâ€™s objective and solved the challenge.

----
### Bypassing IP-Based Authentication Using Burp Suite

### **Introduction**
This write-up demonstrates how to bypass an IP-based authentication mechanism in a web application using Burp Suite. By leveraging the `TRACE` HTTP method and modifying request headers in Burp Proxy, we can gain unauthorized access to the admin panel.

---

### **Step 1: Identifying the Restriction**
1. Open Burp Suite and navigate to the `Repeater` tab.
2. Send a `GET` request to the admin panel:
   
   ```http
   GET /admin HTTP/1.1
   Host: target.com
   ````
   
3. Observe the response, which states that access to the admin panel is restricted to either:
   - Logged-in administrators, or
   - Requests originating from a local IP (`127.0.0.1`).

---

### **Step 2: Using the TRACE Method to Inspect Headers**
1. Modify the request method to `TRACE` and send the request:
   
   ```http
   TRACE /admin HTTP/1.1
   Host: target.com
   ```
   
2. Review the response. Notice that the server automatically appends the `X-Custom-IP-Authorization` header, which contains your IP address. This suggests the header is being used for IP-based authentication.

---

### **Step 3: Injecting a Local IP via Burp Proxy**
1. Navigate to `Proxy > Match and Replace` in Burp Suite.
2. Click `Add` to create a new match-and-replace rule.
3. Configure the rule as follows:
   - **Match field:** Leave empty
   - **Type:** Request header
   - **Replace field:**
     
     ```
     X-Custom-IP-Authorization: 127.0.0.1
     ```
4. Click `Test` and verify that the auto-modified request now contains the fake localhost IP.
5. Click `OK` to save the rule.

---

### **Step 4: Gaining Admin Access**
1. Browse to the home page or revisit `/admin`.
2. Observe that you now have admin privileges and can delete user `carlos` or perform other administrative actions.

---

