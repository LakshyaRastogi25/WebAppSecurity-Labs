### Lab: Information disclosure in version control history
----
**1. Identifying the Vulnerability:**

The lab contained an exposed .git directory, which allowed access to the version control history of the application.

By browsing to http://<lab-id>.web-security-academy.net/.git/, I was able to confirm the presence of Git version control data.
![Screenshot from 2025-01-16 17-47-12](https://github.com/user-attachments/assets/0984c1af-ab5d-4a3d-be96-97be7ec9b031)

Downloading the .git Directory:

Using the wget command, I recursively downloaded the entire .git directory:

````
wget -r https://<lab-id>.web-security-academy.net/.git/
````
This fetched all the Git repository metadata, including commit history and configuration files.
![Screenshot from 2025-01-16 17-49-04](https://github.com/user-attachments/assets/29161292-cb55-4b6c-81eb-97679fbf47f9)

**2. Reconstructing the Git Repository:**

After downloading the .git directory, I navigated to the directory and used Git to reset and reconstruct the repository:

cd <downloaded-directory>/.git/

This restored the repository to its last known state based on the commit history.

Analyzing the Commit History:

**3.I checked the commit history using the command:**
````
git log --oneline
````
**4. This revealed two commits:**
````
5b2a1ea: "Remove admin password from config"

6994af5: "Add skeleton admin panel"
````
The relevant commit for the lab was 5b2a1ea, which mentioned the removal of the admin password from the configuration file (admin.conf).
![Screenshot from 2025-01-16 17-52-44](https://github.com/user-attachments/assets/a5fd660c-f990-43f4-98c9-c992efd0bef2)

**5. Inspecting the Commit Diff:**

To examine the specific changes made in commit 5b2a1ea, I used:
````
git show 5b2a1ea
````
The diff revealed that the commit replaced a hard-coded admin password (4ogk1bxrznrobkl1prxn) with an environment variable (env('ADMIN_PASSWORD')).

The hard-coded password was still visible in the commit diff, which was the key piece of information needed to log in as the administrator.
![Screenshot from 2025-01-16 17-53-36](https://github.com/user-attachments/assets/6d97de0c-612c-4eea-a288-4f8b6c198d41)

**6.Logging in to the Admin Panel:**

With the leaked password (4ogk1bxrznrobkl1prxn), I navigated to the admin login page of the lab.

Using the username administrator and the leaked password, I successfully logged in to the admin interface.

Deleting the User "Carlos":

After gaining access to the admin panel, I followed the instructions in the lab to delete the user "Carlos."
![Screenshot from 2025-01-16 17-54-51](https://github.com/user-attachments/assets/ff597550-d447-430c-b998-7d10d5f12e64)

This completed the labâ€™s objective and solved the challenge.

----
### Bypassing IP-Based Authentication Using Burp Suite

### **Introduction**
This write-up demonstrates how to bypass an IP-based authentication mechanism in a web application using Burp Suite. By leveraging the `TRACE` HTTP method and modifying request headers in Burp Proxy, we can gain unauthorized access to the admin panel.

---

### **Step 1: Identifying the Restriction**
1. Open Burp Suite and navigate to the `Repeater` tab.
2. Send a `GET` request to the admin panel:
   
   ```http
   GET /admin HTTP/1.1
   Host: target.com
   ````
   
3. Observe the response, which states that access to the admin panel is restricted to either:
   - Logged-in administrators, or
   - Requests originating from a local IP (`127.0.0.1`).
![Screenshot from 2025-01-14 20-09-35](https://github.com/user-attachments/assets/9aa67ab7-9f79-4348-b713-0de7e219930a)

---

### **Step 2: Using the TRACE Method to Inspect Headers**
1. Modify the request method to `TRACE` and send the request:
   
   ```http
   TRACE /admin HTTP/1.1
   Host: target.com
   ```
   
2. Review the response. Notice that the server automatically appends the `X-Custom-IP-Authorization` header, which contains your IP address. This suggests the header is being used for IP-based authentication.
![Screenshot from 2025-01-14 19-51-44](https://github.com/user-attachments/assets/1330edb8-9065-4d05-a448-0887ec62090d)

---

### **Step 3: Injecting a Local IP via Burp Proxy**
1. Navigate to `Proxy > Match and Replace` in Burp Suite.
2. Click `Add` to create a new match-and-replace rule.
3. Configure the rule as follows:
   - **Match field:** Leave empty
   - **Type:** Request header
   - **Replace field:**
     
     ```
     X-Custom-IP-Authorization: 127.0.0.1
     ```
   ![Screenshot from 2025-01-14 20-09-22](https://github.com/user-attachments/assets/d9227da7-fbbe-426a-8a4b-b56b4c39915f)

4. Click `Test` and verify that the auto-modified request now contains the fake localhost IP.
5. Click `OK` to save the rule.

---

### **Step 4: Gaining Admin Access**
1. Browse to the home page or revisit `/admin`.
2. Observe that you now have admin privileges and can delete user `carlos` or perform other administrative actions.
![Screenshot from 2025-01-14 20-08-47](https://github.com/user-attachments/assets/6d031592-134f-42e9-a1c0-dbe76445b8e6)

---

### LAB 3: Information disclosure in error messages

### **Introduction**
This write-up demonstrates how to identify the backend framework used by a web application by injecting unexpected data types into request parameters. This technique can lead to information disclosure, which attackers can leverage for further exploitation.

---

### **Step 1: Observing the Product Page Request**
1. Ensure Burp Suite is running and intercepting traffic.
2. Open a product page on the target website.
3. In Burp, navigate to `Proxy > HTTP history` and locate the `GET` request for the product page:
   
   ```http
   GET /product?productId=1 HTTP/1.1
   Host: target.com
   ```
   
   The `productId` parameter is used to fetch product details.

---

### **Step 2: Modifying the productId Parameter**
1. Send the `GET /product?productId=1` request to Burp `Repeater`.
2. Change the `productId` value to a non-integer data type, such as a string:
   
   ```http
   GET /product?productId="example" HTTP/1.1
   Host: target.com
   ```
3. Send the modified request.
4. Observe the response. If the server fails to handle the unexpected data type correctly, it may return an error message with a full stack trace.

---

### **Step 3: Extracting Valuable Information**
1. Analyze the error message in the response.
2. The stack trace reveals that the web application is running **Apache Struts 2 version 2.3.31**.

---

### **Step 4: Completing the Lab**
1. Return to the lab interface.
2. Click `Submit solution`.
3. Enter `2 2.3.31` as the identified framework version to complete the challenge.

---

### Lab 4: Information disclosure on debug page

### **Introduction**
This write-up demonstrates how to identify the backend framework used by a web application by injecting unexpected data types into request parameters. This technique can lead to information disclosure, which attackers can leverage for further exploitation.

---

### **Step 1: Observing the Product Page Request**
1. Ensure Burp Suite is running and intercepting traffic.
2. Open a product page on the target website.
3. In Burp, navigate to `Proxy > HTTP history` and locate the `GET` request for the product page:
   
   ```http
   GET /product?productId=1 HTTP/1.1
   Host: target.com
   ```
   
   The `productId` parameter is used to fetch product details.

---

### **Step 2: Modifying the productId Parameter**
1. Send the `GET /product?productId=1` request to Burp `Repeater`.
2. Change the `productId` value to a non-integer data type, such as a string:
   
   ```http
   GET /product?productId="example" HTTP/1.1
   Host: target.com
   ```
3. Send the modified request.
4. Observe the response. If the server fails to handle the unexpected data type correctly, it may return an error message with a full stack trace.

---

### **Step 3: Extracting Valuable Information**
1. Analyze the error message in the response.
2. The stack trace reveals that the web application is running **Apache Struts 2 version 2.3.31**.

---

### **Step 4: Completing the Lab**
1. Return to the lab interface.
2. Click `Submit solution`.
3. Enter `2 2.3.31` as the identified framework version to complete the challenge.

---

### **Extracting Sensitive Information via Burp Suite**

### **Step 1: Locating Hidden Debug Information**
1. With Burp Suite running, navigate to the home page of the target application.
2. Go to `Target > Site Map`.
3. Right-click on the top-level entry for the lab and select `Engagement tools > Find comments`.
4. Review the comments found in the HTML. Notice that an HTML comment references a hidden `Debug` link pointing to `/cgi-bin/phpinfo.php`.

---

### **Step 2: Retrieving Debug Information**
1. In the `Site Map`, locate the `/cgi-bin/phpinfo.php` entry.
2. Right-click on it and select `Send to Repeater`.
3. In `Burp Repeater`, send the request to retrieve the file:
   
   ```http
   GET /cgi-bin/phpinfo.php HTTP/1.1
   Host: target.com
   ```
   
4. Analyze the response, which reveals various debugging details, including environment variables.
5. Locate the `SECRET_KEY` environment variable in the response.

---

### **Step 3: Completing the Lab**
1. Go back to the lab interface.
2. Click `Submit solution`.
3. Enter the extracted `SECRET_KEY` value to successfully solve the lab.

---
