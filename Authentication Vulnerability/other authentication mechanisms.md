Other mechanisms include -
1. Reset password functionality :- 

a) forgot password

b) change password

2. Remember me functionality.

3. Lock out mechanism.

1st- Lab Write-Up: Password brute-force via password change

Step 1: Initial Setup

Configure Burp Suite and ensure your browser is properly set up to route traffic through the proxy.

Access the lab and log in using the provided credentials.

Step 2: Observing the Password Change Functionality

Navigate to the "Change Password" feature on the application.

Note that the form requires three fields:

Current Password

New Password

Confirm New Password

Perform the following observations:

When you submit an incorrect Current Password with matching New Password and Confirm New Password, the account gets blocked after multiple attempts.

When you provide the correct Current Password but different values for New Password and Confirm New Password, the application throws an error message:
"New passwords don’t match."

Step 3: Exploiting the Functionality

Recognize that the error message for mismatched new passwords can help identify the correct Current Password.

Use Burp Suite to capture the POST request for changing the password:

Send the request to the Intruder tool.

Modify the username parameter to target the victim username carlos.

Set the current-password parameter as the payload position.

Step 4: Configuring the Intruder Attack

In Payloads, upload a wordlist of potential passwords for the current-password parameter.

In Grep – Match settings:

Add the string "New passwords don’t match" to identify successful guesses.

Start the attack.

Step 5: Analyzing the Results

Observe the responses in the attack results. Under the "New passwords don’t match" column, look for the payload that triggers this message.
Identify the correct password for carlos (in this case, 123456).

Step 6: Logging In

Use the identified password (123456) to log in as carlos.

Successfully solve the lab!
Key Takeaways

This attack leverages a logic flaw in the password change functionality, allowing brute force attempts without account lockout.

The error messages provide unintended feedback, aiding in identifying valid credentials.

Always validate and handle error messages securely to prevent information disclosure.

2nd - Lab: Brute-forcing a stay-logged-in cookie

Your credentials: wiener:peter

Victim's username: carlos

1. Log in to your account

Enable the "Stay logged in" option.

Notice that a stay-logged-in cookie is created.

2.Inspect the cookie

Use Burp's Inspector panel to view the cookie.

Decode it (Base64) and observe its format: username:md5HashOfPassword.

3.Verify the hash

Hash your password using MD5.

Check if the hash matches the second part of the decoded cookie.

Confirm that the cookie format is base64(username + ':' + md5HashOfPassword).

4.Log out and send the request to Burp Intruder

Log out of your account.

Find the most recent GET /my-account?id=wiener request in Burp.

Highlight the stay-logged-in cookie and send the request to Intruder.

5.Set up Burp Intruder

Ensure the stay-logged-in cookie is set as the payload position.

Add your own password as a payload (for testing).

Add these Payload Processing Rules:
Hash: MD5

Add Prefix: wiener:

Encode: Base64
![Screenshot from 2024-11-29 17-21-27](https://github.com/user-attachments/assets/21f087e9-4976-4697-8646-86e740e6555e)

6.Add a response check

In Intruder, add a grep match rule to flag responses containing the string Update email.

7.Run the attack

Start the attack and confirm that a valid payload allows access to your account.
![Screenshot from 2024-11-29 17-21-27](https://github.com/user-attachments/assets/bb0e007a-da43-403b-bcad-61a2a7a01152)

8.Adjust for Carlos's account

Replace your password with a list of candidate passwords.

Change the id parameter in the request URL from wiener to carlos.

Update the Add Prefix rule to use carlos: instead of wiener:.

9.Run the attack again

Start the attack.

Look for the response containing the Update email button.

The payload in this response is the valid stay-logged-in cookie for Carlos's account.

Lab Solved
![Screenshot from 2024-11-29 17-20-38](https://github.com/user-attachments/assets/69ee33c1-e01a-49f9-8611-5810db97b232)

Use the payload to access Carlos's account.
