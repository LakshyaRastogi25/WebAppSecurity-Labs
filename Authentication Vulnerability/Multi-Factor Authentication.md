**Two-factor authentication** (2FA) is based on something you know and something you have. This usually requires users to enter both a traditional password and a temporary verification code from an out-of-band physical device in their possession.

What are **Authentication Tokens**?

Authentication tokens are digital or physical mechanisms used to prove a user's identity and grant them access to systems or applications. They are often used as part of MFA (e.g., the "something you have" factor).

Examples of Authentication Tokens are :-
a) One-Time password (OTP)

b) Json Web Token (JWT)

c) Physical Tokens (key fob)

**LAB:1**

**Lab: 2FA simple bypass**

**AIM**- This lab's two-factor authentication can be bypassed. To solve the lab, access Carlos's account page.

**Given Credentials**-

->Your credentials: wiener:peter

->Victim's credentials carlos:montoya

Step 1: Access the Lab and Login with Your Credentials

Action: Log in to the application using the provided credentials.

Observation: After a successful login, the application prompts you to enter a verification code that has been sent to your email.

Submit: Enter the correct verification code from your email to complete the login process.

Step 2: Log Out and Enter Victim Credentials

Action: Log out of your current session.

Victim Login: Enter the victim's credentials (provided in the lab).

Observation: After entering the credentials, you will be prompted to enter a verification code (just like in Step 1).

Step 3: Bypass the MFA

Action: To bypass the MFA, modify the URL by removing the "/login2" parameter.

You will notice that after doing so, the application will redirect you to the home page.

Navigate: Once on the home page, click on the "My Account" section on the left side of the page.

Step 4: Explanation of the Logic Flaw

Analysis: The application has a logic flaw that makes the MFA ineffective in certain scenarios. After submitting the victimâ€™s credentials, the system logically authenticates the user, and the MFA becomes a redundant step.

Conclusion: The two-factor authentication (2FA) in this case is merely a weak barrier that has been misconfigured, allowing attackers to bypass it easily by manipulating the URL.

**LAB:2**

**Lab: 2FA simple bypass**

**AIM**- This lab's two-factor authentication is vulnerable due to its flawed logic. To solve the lab, access Carlos's account page.

**Given Credentials**-
->Your credentials: wiener:peter

->Victim's username: carlos

Step 1: Access the Lab and Configure Burp Suite

Access the lab and configure Burp Suite as your proxy.

Ensure intercept is enabled.

Set up the browser to route traffic through Burp Suite.

Log in with the provided wiener credentials:

Username: wiener
Password: peter

Retrieve the verification code sent to the client email to simulate a valid MFA flow.

Step 2: Analyze the GET /login Request

Observe the GET /login request in Burp Suite.

Look for the verify parameter in the request.

Notice that the verify parameter is set to wiener.

Step 3: Analyze the POST /login2 Request

Submit the verification code as instructed by the lab.

Capture the POST /login2 request in Burp Suite and analyze its contents.

Parameters include:

verify: The username (e.g., wiener).

session: The session token.

mfa-code: The Multi-Factor Authentication code.

Step 4: Modify the verify Parameter

Send the GET /login request to Burp Repeater.

Change the verify parameter from wiener to carlos and send the request.

Copy the session token from the response (this token now corresponds to the carlos user).

Step 5: Launch a Brute-Force Attack on the MFA Code

Send the POST /login2 request to Burp Intruder.

Set the following payload positions:

Change the verify parameter to carlos.

Update the session token to the one retrieved in Step 4.

Add the mfa-code parameter to the payload.

Configure the attack:

Go to the Payloads tab.

Select Brute Force as the payload type.

Set the range of the payload:

Min: 0000

Max: 9999

Use only numerical characters (remove any alphabetic characters from the payload list).

Start the brute-force attack.

Step 6: Identify a Successful Code

Look for a 302 status code in the Intruder results, indicating a successful login.

Copy the successful request to Burp Repeater.

![Screenshot from 2024-11-23 11-44-22](https://github.com/user-attachments/assets/8c5b9329-18e0-4678-8f93-3d038967982e)

Step 7: Finalize the Exploit

Send the successful POST /login2 request from Repeater with:

verify: carlos

session: Valid session token.

![Screenshot from 2024-11-23 11-48-41](https://github.com/user-attachments/assets/2320b231-8976-494b-bb20-edcc2f2865ba)

mfa-code: The brute-forced MFA code.

Open the session in a new browser tab to confirm access to Carlos's account.

![Screenshot from 2024-11-23 11-43-58](https://github.com/user-attachments/assets/8404a556-e624-4b77-8061-50fb387248c9)

Step 8: Explanation of the Vulnerability

The application fails to securely enforce MFA, allowing brute-force attacks on the MFA code.

The logic flaw permits session token reuse after modifying the verify parameter, bypassing intended access restrictions.

The MFA code is vulnerable to brute-forcing due to its short length (4 digits) and lack of rate-limiting.


