---
# Lab:1 Reflected XSS into HTML context with nothing encoded
# **Write-Up: Reflected XSS in Search Functionality**  

### **Overview**  
This lab demonstrates a reflected Cross-Site Scripting (XSS) vulnerability in the search functionality of a web application. The input is reflected in the response without proper sanitization, allowing an attacker to inject and execute malicious scripts.  

### **Steps to Exploit**  

1. **Testing Input Reflection:**  
   - I entered a simple string `"Heyy"` in the search bar.  
   - The response reflected my input in the HTML page, confirming that user input is returned without encoding.  

2. **Injecting a Basic XSS Payload:**  
   - To verify XSS, I injected the following payload in the search input:  
     ```html
     <script>alert(1)</script>
     ```
   - Upon submitting, the browser executed the JavaScript, displaying an alert box with `1`.  

3. **Confirmation of Vulnerability:**  
   - Since the JavaScript executed successfully, the application is vulnerable to reflected XSS.  

---
 

---
# Lab 2: 
# **Exploiting XSS Through Burp Intruder**

## **Step 1: Testing for Initial XSS Filtering**
To begin, we attempted to inject a standard XSS vector:  

```html
<img src=1 onerror=print()>
```
However, this payload was **blocked** by the application’s filtering mechanisms. Since our initial attempt failed, we need to **analyze which tags and attributes are allowed** by the application.  

---

## **Step 2: Identifying Allowed HTML Tags Using Burp Intruder**
1. **Open Burp's browser** and use the search function in the lab.  
2. **Send the resulting request to Burp Intruder** for further testing.  
3. In **Burp Intruder**, replace the value of the search term with:  

   ```html
   <>
   ```
4. Place the cursor **between the angle brackets** and click **Add §** to create a payload position.  
   - The value should now look like:  
     ```html
     <§§>
     ```
5. **Visit the XSS cheat sheet** and click **Copy tags to clipboard**.  
6. In the **Payloads** panel, under **Payload configuration**, click **Paste** to insert the list of tags into the payload list.  
7. Click **Start attack** to test which tags are allowed.  

### **Results Analysis:**
- Most payloads caused a **400 Bad Request** response, indicating they were blocked.  
- However, the **`<body>` tag** resulted in a **200 OK** response, meaning it was not filtered.  
- This suggests that **the `<body>` tag is allowed**, and we can attempt further exploitation using it.  

---

## **Step 3: Injecting Attributes Into `<body>`**
Since `<body>` is allowed, we now need to determine **which attributes are accepted**.

1. **Modify the Burp Intruder search term** and replace it with:  

   ```html
   <body%20=1>
   ```
2. **Place the cursor before the `=` character** and click **Add §** to create a payload position.  
   - The value should now look like:  
     ```html
     <body%20§§=1>
     ```
3. **Visit the XSS cheat sheet** and click **Copy events to clipboard**.  
4. In the **Payloads** panel, click **Clear** to remove previous payloads.  
5. Click **Paste** to insert the **list of attributes** into the payloads list.  
6. Click **Start attack** to test which event handlers are allowed.  

### **Results Analysis:**
- Most attributes caused a **400 response**, meaning they were blocked.  
- However, the **`onresize` attribute** resulted in a **200 OK** response, meaning it was accepted.  
- This indicates that we can execute JavaScript using **`onresize=print()`**.  

---

## **Step 4: Delivering the Exploit**
Now that we know the **`onresize` attribute works**, we will craft a final payload to **execute JavaScript on the victim's browser**.  

1. Go to the **exploit server** and paste the following payload:  

   ```html
   <iframe src="https://YOUR-LAB-ID.web-security-academy.net/?search=%22%3E%3Cbody%20onresize=print()%3E" onload=this.style.width='100px'>
   ```
2. Replace **`YOUR-LAB-ID`** with the actual **Lab ID** for your target.  
3. Click **Store** and then **Deliver exploit to victim**.  

