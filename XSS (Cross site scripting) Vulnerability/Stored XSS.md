---
# Lab: 1 Stored XSS into HTML context with nothing encoded
## **Write-Up: Stored XSS in Blog Comment Section**  

### **Overview**  
This lab demonstrates a **Stored Cross-Site Scripting (XSS) vulnerability** in the blog’s comment functionality. Unlike **Reflected XSS**, which executes immediately, **Stored XSS** persists in the application and affects all users who view the compromised page.  

### **Steps to Exploit**  

1. **Identifying a Potential Injection Point:**  
   - The website has a comment section where users can enter a name, email, website, and a comment.  
   - Since comments are stored and displayed on the blog, I tested for possible XSS injection.  

2. **Injecting a Malicious Script:**  
   - In the comment box, I entered the following payload:  
     ```html
     <script>alert(1)</script>
     ```  
   - I filled in the other required fields (name, email, and website) and clicked **"Post comment"**.  

3. **Triggering the XSS Payload:**  
   - After submitting the comment, I navigated back to the blog post.  
   - The alert box popped up, confirming that my JavaScript payload was executed.  
   - This means that every visitor to the blog post will also execute this script in their browser.   

--- 

# **Lab Write-Up: Stored XSS into anchor href attribute with double quotes HTML-encoded**  

### **Step 1: Understanding the Vulnerability**  
- The **comment functionality** is vulnerable to **stored XSS**.  
- User input is reflected inside the **`href` attribute** of the comment author’s name:  

  ```html
  <a id="author" href="USER_INPUT">Author Name</a>
  ```  
- Our goal is to **inject JavaScript into the `href` attribute** so that clicking the author’s name executes `alert(1)`.  

---

### **Step 2: Crafting the Payload**  
Since our input is placed inside `href`, we can use the **`javascript:` pseudo-protocol** to execute JavaScript when the link is clicked.  

**Final Payload:**  
```
javascript:alert(1)
```

---

### **Step 3: Exploiting the Vulnerability**  
1. **Go to the comment section** of the website.  
2. **Submit a comment** with your payload as the author’s name or website field:  
   ```
   javascript:alert(1)
   ```
3. **After submission, inspect the rendered HTML** to confirm your input is reflected inside `href`:  
   ```html
   <a id="author" href="javascript:alert(1)">Author Name</a>
   ```
4. **Click on the author’s name**, and the JavaScript executes, displaying an alert box.  

---

### **Step 4: Lab Completion**  
- The **`alert(1)` executes successfully** when the author name is clicked.  
- This confirms a **successful stored XSS attack**.  
- **Lab is now solved!**  

# lab 3
# **Lab Write-Up: Accesskey-Based XSS in the Comment Author's Website Field**  

### **Understanding the Vulnerability**  
This lab contains a **stored cross-site scripting (XSS) vulnerability** in the **comment functionality**. The issue occurs because the **Website** field in the comment form is reflected inside an `<a>` tag as the `href` attribute without proper sanitization.  

#### **Reflected HTML Code:**
```html
<a id="author" href="USER_INPUT">kyu btau</a>
```
Since **our input is directly placed inside the `href` attribute**, we can try **injecting additional attributes** using special encoding techniques.  

---

### **Crafting the Payload**
Since the `href` value is wrapped in double quotes (`"`), we need to **break out of it** safely and inject our own attributes.  
Using URL encoding, we crafted the following payload:  

**Final Payload (to enter in the Website field):**  
```
?%27accesskey=%27x%27onclick=%27alert(1)
```

---

### **How the Payload Works**
After submission, the input is reflected as:  
```html
<a id="author" href="?' accesskey='x' onclick='alert(1)'>kyu btau</a>
```
**`?`** → Ensures it’s treated as part of the URL.  
**`%27` (`'`)** → **Closes the `href` attribute safely** to prevent breaking the tag structure.  
**`accesskey='x'`** → Defines a keyboard shortcut (`Alt + Shift + X`) to activate the element.  
**`onclick='alert(1)'`** → Executes JavaScript when the access key is triggered.  

---

### **Steps to Exploit**
**Enter the payload** in the **Website** field when submitting a comment:  
```
?%27accesskey=%27x%27onclick=%27alert(1)
```
**Submit the comment.**  
**Inspect the rendered HTML** (`Ctrl + U`) to confirm that `accesskey` and `onclick` were injected.  
**Trigger the attack** by pressing:  
   ```
   Alt + Shift + X
   ```
   **On Ubuntu (Chromium), this activates the accesskey and executes `alert(1)`.**  

---

### **Expected Outcome**
 - The JavaScript `alert(1)` executes when the keyboard shortcut **`Alt + Shift + X`** is pressed.
 - Since this is a **stored XSS**, it **affects all users viewing the comment**.  
**Lab is solved!**  

---

