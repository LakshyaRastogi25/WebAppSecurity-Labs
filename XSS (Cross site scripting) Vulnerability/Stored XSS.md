---
# Lab: 1 Stored XSS into HTML context with nothing encoded
## **Write-Up: Stored XSS in Blog Comment Section**  

### **Overview**  
This lab demonstrates a **Stored Cross-Site Scripting (XSS) vulnerability** in the blog’s comment functionality. Unlike **Reflected XSS**, which executes immediately, **Stored XSS** persists in the application and affects all users who view the compromised page.  

### **Steps to Exploit**  

1. **Identifying a Potential Injection Point:**  
   - The website has a comment section where users can enter a name, email, website, and a comment.  
   - Since comments are stored and displayed on the blog, I tested for possible XSS injection.  

2. **Injecting a Malicious Script:**  
   - In the comment box, I entered the following payload:  
     ```html
     <script>alert(1)</script>
     ```
     ![Screenshot from 2025-02-19 11-15-52](https://github.com/user-attachments/assets/2b218333-8a9d-40ef-b0bd-93d11ef2f3b3)

   - I filled in the other required fields (name, email, and website) and clicked **"Post comment"**.  

3. **Triggering the XSS Payload:**  
   - After submitting the comment, I navigated back to the blog post.  
   - The alert box popped up, confirming that my JavaScript payload was executed.  
   - This means that every visitor to the blog post will also execute this script in their browser.   
![Screenshot from 2025-02-19 11-15-34](https://github.com/user-attachments/assets/fb5af8fa-b847-452c-81b4-7c90ec17a25e)

--- 

# **Lab 2 Write-Up: Stored XSS into anchor href attribute with double quotes HTML-encoded**  

### **Step 1: Understanding the Vulnerability**  
- The **comment functionality** is vulnerable to **stored XSS**.  
- User input is reflected inside the **`href` attribute** of the comment author’s name:  

  ```html
  <a id="author" href="USER_INPUT">Author Name</a>
  ```  
- Our goal is to **inject JavaScript into the `href` attribute** so that clicking the author’s name executes `alert(1)`.  
![Screenshot from 2025-02-22 23-44-33](https://github.com/user-attachments/assets/a54ae343-4a01-4b1d-bff7-9304c1d285cc)

---

### **Step 2: Crafting the Payload**  
Since our input is placed inside `href`, we can use the **`javascript:` pseudo-protocol** to execute JavaScript when the link is clicked.  

**Final Payload:**  
```
javascript:alert(1)
```

---

### **Step 3: Exploiting the Vulnerability**  
1. **Go to the comment section** of the website.  
2. **Submit a comment** with your payload as the author’s name or website field:  
   ```
   javascript:alert(1)
   ```
3. **After submission, inspect the rendered HTML** to confirm your input is reflected inside `href`:  
   ```html
   <a id="author" href="javascript:alert(1)">Author Name</a>
   ```
4. **Click on the author’s name**, and the JavaScript executes, displaying an alert box.  
![Screenshot from 2025-02-22 23-43-58](https://github.com/user-attachments/assets/bb180f5f-cd63-4262-adf1-64650cd5cb0c)

---

### **Step 4: Lab Completion**  
- The **`alert(1)` executes successfully** when the author name is clicked.  
- This confirms a **successful stored XSS attack**.  
- **Lab is now solved!**  
![Screenshot from 2025-02-22 23-43-25](https://github.com/user-attachments/assets/eb0d7bcd-aa3e-4979-8e34-f759fb9f48cf)

# **Lab 3 Write-Up: Stored XSS into onclick event with angle brackets and double quotes HTML-encoded and single quotes and backslash escaped**  

## **1. Understanding the Vulnerability**  
This lab contained a **stored cross-site scripting (XSS) vulnerability** where user input was reflected inside a **JavaScript event handler** (`onclick`). However, certain security measures were in place:  

**Angle brackets (`<`, `>`) were HTML-encoded** → Preventing new HTML tags.  
**Double quotes (`"`) were HTML-encoded** → Preventing breaking out of attributes.  
**Single quotes (`'`) and backslashes (`\`) were escaped** → Preventing breaking out of JavaScript strings.  

The challenge was to **execute JavaScript while bypassing these restrictions**.

---

## **2. Identifying the Bypass**  
During testing, I noticed that **HTML entities were being decoded before JavaScript execution**. This meant that if **single quotes were escaped (`\'`) but not double-escaped (`\\'`), HTML encoding (`&#x27;`) could be used to bypass filtering**.

---

## **3. Crafting the Exploit Payload**  
Since my input was being placed inside a JavaScript string, I needed to:  
1. **Break out of the existing string safely**  
2. **Inject a JavaScript payload (`alert(1)`)**  
3. **Ensure the script remains valid**  

### **Final Payload:**  
```
Hello!&#x27;); alert(1);//  
```

---

### **4. How the Payload Works**  
1. **`&#x27;` is the HTML entity for a single quote (`'`).**  
   - When the browser processes the page, **it decodes `&#x27;` back into `'`**, allowing the string to be closed.  
2. **`);` closes the existing JavaScript statement.**  
3. **`alert(1);` executes immediately.**  
4. **`//` comments out the rest of the JavaScript code to prevent syntax errors.**  

**Final Rendered JavaScript After Injection:**  
```js
onclick="var input='Hello!'); alert(1);//';"
```
This successfully **breaks out of the JavaScript string and executes `alert(1)`**.

---

## **5. Steps to Exploit the Vulnerability**  
1. **Locate the input field where the `onclick` event is stored.**  
2. **Enter the following payload into the input field:**  
   ```
   Hello!&#x27;); alert(1);//  
   ```
3. **Submit the form.**  
4. **When the stored input is clicked, the JavaScript executes, triggering `alert(1)`.**  

---

## **6. Expected Outcome**  
- **The injected payload successfully bypasses input filtering.**  
- **JavaScript executes when the event is triggered.**  
- **Lab is solved.**  
![Screenshot from 2025-02-25 11-10-46](https://github.com/user-attachments/assets/be239cc9-a7ad-4a07-99d4-12eb29e06d0f)

---

## **7. Security Impact & Mitigation**  
This type of attack allows an attacker to:  
- **Execute arbitrary JavaScript in a victim's browser.**  
- **Steal session cookies and perform account takeovers.**  
- **Modify page content to inject phishing attacks.**  
---
