**Lab 1: OS command injection, simple case**

**AIM - To solve the lab, execute the whoami command to determine the name of the current user.**
Here's a well-structured write-up for your task:  

---

1. **Intercept the Stock Check Request:**  
   - Open **Burp Suite** and ensure **Intercept** is enabled in the **Proxy** tab.  
   - Navigate to the stock check functionality in the target web application.  
   - Submit a request to check stock levels, capturing it in **Burp Suite**.  

2. **Modify the Request:**  
   - Locate the **storeID** parameter in the intercepted request.
![Screenshot from 2025-01-10 10-51-59](https://github.com/user-attachments/assets/083fa4af-ae26-4e68-8d7c-c7a35282e04a)

   - Change its value to:  
     ```
     1|whoami
     ```
   - This injection attempts to execute the `whoami` command on the server.  

3. **Forward the Modified Request:**  
   - Click **Forward** to send the modified request to the server.  

4. **Analyze the Response:**  
   - Observe that the response includes the output of the `whoami` command, revealing the current system user.  
![Screenshot from 2025-01-10 10-51-39](https://github.com/user-attachments/assets/8f7a5d99-e3b3-404e-b057-c8bd40263110)

**Lab 2: Blind OS command injection with time delays**

**AIM - To solve the lab, exploit the blind OS command injection vulnerability to cause a 10 second delay.**

---

## **Steps to Exploit the Command Injection Vulnerability**  

### **1. Intercept the Feedback Submission Request**  
- Open **Burp Suite** and ensure **interception is enabled** in the **Proxy** tab.  
- Navigate to the **feedback submission page** of the target web application.  
- Fill in the form with dummy data and submit it.
![Screenshot from 2025-01-10 18-56-43](https://github.com/user-attachments/assets/f388069f-6720-43f6-9284-27bfb3113bcf)
 
- Burp Suite will capture the request.  

---

### **2. Modify the Email Parameter for Command Injection**  
- Locate the **email parameter** in the request, which typically looks like this:  

  ```
  email=user@example.com
  ```

- Modify it to inject a **ping command**:  

  ```
  email=abc%40gmail.com||ping+-c+10+127.0.0.1||
  ```

- The `||` characters attempt to **chain a new command** after the email value.  
- `ping -c 10 127.0.0.1` sends **10 ICMP requests** to `127.0.0.1` (localhost).  

![Screenshot from 2025-01-10 19-10-33](https://github.com/user-attachments/assets/93eeb7b0-99e3-4c3a-b51f-17aa243af7f3)

---

### **3. Send the Modified Request**  
- Forward the request to the server.  
- Observe the response time in **Burp Suiteâ€™s HTTP history**.  

---

### **4. Analyze the Response**  
- The response should take approximately **10 seconds** to return.  
- This delay confirms that the **ping command was executed on the server**.  
- The web application is **vulnerable to command injection** because it does not properly sanitize user input.  

---
![Screenshot from 2025-01-10 19-10-57](https://github.com/user-attachments/assets/ad8d7575-8cd3-4f6f-b9ad-10b548605ff0)

**Lab 3: Blind OS command injection with output redirection**

**AIM - To solve the lab, execute the whoami command and retrieve the output.**

---

## **Steps to Exploit the Command Injection Vulnerability**  

### **1. Intercept the Feedback Submission Request**  
- Open **Burp Suite** and ensure **interception is enabled** in the **Proxy** tab.  
- Navigate to the **feedback submission page** of the target web application.  
- Fill in the form with dummy data and submit it.
![Screenshot from 2025-01-10 19-27-57](https://github.com/user-attachments/assets/dfe1350c-d3ea-42ac-bf6b-844228a0afcc)
 
- Burp Suite will capture the request.  
- I tried using ping command to check if its vulnerable to blind os command injection
---

### **2. Modify the Email Parameter for Command Injection**  
- Locate the **email parameter** in the request, which typically looks like this:  

  ```
  email=user@example.com
  ```

- Modify it to inject a **command that writes to a file**:  

  ```
  email=||whoami>/var/www/images/test.txt||
  ```

- This executes the `whoami` command, which returns the **current user** running the application.  
- The output is saved in `/var/www/images/test.txt`, which is a directory likely accessible via the web application.  

- Forward the modified request to the server.  

---

### **3. Retrieve the Command Output via the Image Loading Function**  
- Navigate to a **page that loads product images** in the application.  
- Intercept the request that loads an image file.  
- Locate the **filename parameter**, which usually looks like this:  

  ```
  filename=product49.jpg
![Screenshot from 2025-01-10 19-32-13](https://github.com/user-attachments/assets/62c908c3-947e-4eae-832c-e9536a8be4e5)

  ```

- Modify it to retrieve the previously created file:  

  ```
  filename=test.txt
  ```

- Forward the request and observe the response.  

---

### **4. Analyze the Response**  
- The response should contain the **output of the whoami command**, such as:  
![Screenshot from 2025-01-10 19-32-37](https://github.com/user-attachments/assets/865f3633-6ed8-4014-bedc-691ae04644ac)

  ```
  www-data
  ```

- This confirms that **arbitrary commands** can be executed on the server and their output can be retrieved.  
![Screenshot from 2025-01-10 19-33-04](https://github.com/user-attachments/assets/8b001ac0-1915-4a79-9914-5eae2e021445)

---
