# **Server-Side Request Forgery (SSRF)** 
Is a critical web security vulnerability that allows an attacker to **trick a server into making unauthorized requests to internal or external resources**. Let’s break it down in a simple and memorable way.

---

## **What is SSRF?**
- SSRF occurs when an attacker can **manipulate a server to send requests on their behalf**.
- The server acts as a "proxy" for the attacker, allowing them to access resources that are otherwise inaccessible (e.g., internal systems, cloud metadata, or third-party services).

---

## **Key Idea to Remember**
Think of SSRF as **"using the server as a puppet"**:
- The attacker pulls the strings, and the server does the work.
- The server blindly follows the attacker’s instructions, making requests to places it shouldn’t.

---

## **How Does SSRF Work?**
1. **Vulnerable Input**:
   - The web application takes user input (e.g., a URL) and uses it to make a request to another server or resource.
   - Example: A feature that fetches an image from a user-provided URL.

2. **Malicious Input**:
   - The attacker provides a malicious URL or input that points to an internal resource or a third-party service.
   - Example: Instead of a valid image URL, the attacker provides:
     ```
     http://localhost/admin
     ```
     or
     ```
     http://169.254.169.254/latest/meta-data/
     ```
     (This IP is used in cloud environments like AWS to access instance metadata.)

3. **Server Makes the Request**:
   - The server blindly follows the attacker’s input and makes the request.
   - If the server has access to internal systems, the attacker can:
     - Access sensitive data (e.g., internal APIs, databases).
     - Exploit internal services (e.g., bypass firewalls).
     - Perform reconnaissance (e.g., scan internal networks).

---

### **Example of SSRF**
Imagine a web application that lets users upload a profile picture by providing a URL. The server fetches the image from the URL and saves it.

#### Normal Use Case:
- User provides: `https://example.com/profile.jpg`
- Server fetches the image and saves it.

## SSRF Attack:
- Attacker provides: `http://localhost/admin`
- Server fetches the contents of the internal admin page and returns it to the attacker.

---

### **Types of SSRF**
1. **Basic SSRF**:
   - The server fetches data and returns it to the attacker.
   - Example: Fetching internal files or APIs.

2. **Blind SSRF**:
   - The server makes the request, but the attacker doesn’t see the response directly.
   - Example: Triggering actions on internal systems (e.g., deleting a file).

---

## **Why is SSRF Dangerous?**
1. **Access to Internal Systems**:
   - Attackers can access internal APIs, databases, or services that are not exposed to the internet.

2. **Cloud Metadata Exploitation**:
   - In cloud environments (e.g., AWS, Azure), attackers can access metadata services to steal credentials or sensitive information.

3. **Port Scanning**:
   - Attackers can scan internal networks to identify open ports and services.

4. **Bypass Firewalls**:
   - Since the request comes from the server (which is trusted), attackers can bypass firewalls and access restricted resources.

---

### **Real-World SSRF Examples**
1. **Accessing Cloud Metadata**:
   - In AWS, the metadata service is available at `http://169.254.169.254/`.
   - An SSRF vulnerability could allow an attacker to steal cloud credentials.

2. **Internal API Access**:
   - An attacker could use SSRF to access internal APIs, such as:
     ```
     http://localhost:8080/internal-api
     ```

3. **File Access**:
   - An attacker could read sensitive files on the server, such as:
     ```
     file:///etc/passwd
     ```

---

### **How to Prevent SSRF**
1. **Validate and Sanitize Input**:
   - Restrict user input to allowed domains or IP ranges.
   - Example: Only allow URLs from trusted domains (e.g., `https://example.com`).

2. **Use Allowlists**:
   - Maintain a list of allowed resources (e.g., domains, IPs) and reject all others.

3. **Disable Unused Protocols**:
   - Block protocols like `file://`, `ftp://`, and `gopher://` unless absolutely necessary.

4. **Restrict Internal Access**:
   - Ensure the server cannot access sensitive internal resources (e.g., metadata services, admin panels).

5. **Use Security Libraries**:
   - Use libraries or frameworks that handle URL fetching securely and prevent SSRF.

6. **Monitor and Log Requests**:
   - Log all outgoing requests to detect suspicious activity.

---
